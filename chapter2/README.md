# Chapter 2

本章的主要内容是完成了命令 `who` 和 `cp` 。

### 命令 `who`

- who1.c：实现了基本的命令 `who` 的功能（从 `/var/run/utmp` 中读取登录用户信息，并按照 `用户名  终端名  登录时间  登录地址` 的格式进行显示）；
- who2.c：修改了 who1.c 中的一些问题；
  - 消除了空白记录：根据 `utmp` 结构体中的 `ut_type` 类型判断是否是活动用户（Active users）来决定是否打印；
  - 使时间按照正确形式进行显示：`utmp` 中的 `ut_tv.tv_sec` 是 Absolute Time（从 1970.1.1 00:00:00 开始所经过的秒数），使用 `ctime` 函数将其转为正确格式的时间字符串，并调整字符串按照类似 `2021-Sep-1 18:33` 的格式进行显示。

### 命令 `cp`

- cp1.c：实现了文件的复制功能，调用方式为 `cp src_file dst_file` ；并进行了一些异常情况（文件打开错误、关闭错误……）的捕捉。